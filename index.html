<!DOCTYPE html>
<html>
<head>
  <meta charset='UTF-8'>
  <title>Ghost SQL Import</title>
  <style>
    body{font-family:sans-serif;background:#667eea;min-height:100vh;display:flex;align-items:center;justify-content:center;padding:20px}
    .container{background:white;padding:40px;border-radius:12px;max-width:600px;width:100%}
    h1{margin-bottom:30px}
    input[type=file]{width:100%;padding:15px;border:2px dashed #ddd;border-radius:8px;margin:20px 0}
    button{width:100%;background:#667eea;color:white;border:none;padding:16px;border-radius:8px;font-size:16px;cursor:pointer}
    button:disabled{background:#ccc}
    #log{background:#1e1e1e;color:#d4d4d4;padding:20px;border-radius:8px;font-family:monospace;font-size:13px;max-height:400px;overflow-y:auto;margin-top:20px;display:none}
    .success{color:#4ec9b0}
    .error{color:#f48771}
  </style>
</head>
<body>
  <div class='container'>
    <h1>Ghost SQL Importer</h1>
    <input type='file' id='file' accept='.sql' multiple>
    <button id='btn' disabled>Select Files First</button>
    <div id='log'></div>
  </div>
  <script>
    let files=[];
    document.getElementById('file').onchange=e=>{
      files=Array.from(e.target.files).sort((a,b)=>a.name.localeCompare(b.name));
      document.getElementById('btn').disabled=!files.length;
      document.getElementById('btn').textContent=files.length?' Start Import ('+files.length+' files)':'Select Files First';
    };
    document.getElementById('btn').onclick=async()=>{
      if(!files.length||!confirm('Import '+files.length+' files?'))return;
      const btn=document.getElementById('btn'),log=document.getElementById('log');
      btn.disabled=true;
      btn.textContent='Importing...';
      log.style.display='block';
      log.innerHTML='';
      for(let i=0;i<files.length;i++){
        const f=files[i];
        log.innerHTML+='<div>['+(i+1)+'/'+files.length+'] '+f.name+'...</div>';
        try{
          const fd=new FormData();
          fd.append('sqlFile',f);
          const r=await fetch('/import',{method:'POST',body:fd});
          const d=await r.json();
          log.innerHTML+='<div class="'+(d.success?'success':'error')+'">'+(d.success?'‚úÖ':'‚ùå')+' '+f.name+'</div>';
        }catch(e){
          log.innerHTML+='<div class="error">‚ùå '+f.name+': '+e.message+'</div>';
        }
        log.scrollTop=log.scrollHeight;
      }
      log.innerHTML+='<div class="success">üéâ Done!</div>';
      btn.textContent='Import Again';
      btn.disabled=false;
    };
  </script>
</body>
</html>
